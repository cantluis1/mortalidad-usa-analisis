---
title: "Análisis Temporal y Demográfico de las Principales Causas de Muerte en Estados Unidos"
author: "Valerie M Y Luis C"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_depth: 3
    theme: flatly
bibliography: "C:/Users/luisc/Downloads/referencias.bib"
csl: "C:/Users/luisc/Downloads/apa.csl"
editor_options: 
  markdown: 
    wrap: 72
---
# **Análisis Exploratorio de Mortalidad en EE.UU. (1999-2017)**

# 1. Introducción

## **1.1. Contexto del Problema**

Las enfermedades crónicas no transmisibles constituyen la principal
carga de mortalidad en Estados Unidos. Afecciones como las enfermedades
cardíacas, el cáncer, las enfermedades cerebrovasculares, la diabetes,
las enfermedades renales, la enfermedad de Alzheimer y las enfermedades
respiratorias crónicas han figurado sistemáticamente entre las
principales causas de defunción durante décadas, configurando los
desafíos centrales para la salud pública del país . A este grupo se
suman causas externas como los suicidios y las lesiones no intencionales
(accidentes), que también representan una parte significativa de la
mortalidad anual y responden a determinantes sociales y conductuales
específicos . Este complejo panorama sanitario, que involucra estilos de
vida, factores ambientales, predisposiciones genéticas y acceso a
servicios de salud, requiere un análisis continuo de su evolución para
comprender los cambios en el perfil epidemiológico de la población.

Sin embargo, la mortalidad no se distribuye uniformemente en el
territorio. Un estudio fundamental de James, Cossman y Wolf (2018)
publicado en *Demographic Research* analizó 48 años de datos de
mortalidad (1968-2015) y descubrió que las disparidades geográficas no
son aleatorias, sino que persisten en el tiempo. Los condados con
mortalidad persistentemente alta se concentran de manera
desproporcionada en el Sur rural, particularmente en la división Este
Sur Central (Kentucky, Tennessee, Mississippi y Alabama). Mientras que
la brecha entre esta región y el resto del país era de aproximadamente
50 muertes por 100,000 habitantes a finales de los años 1960, para
mediados de la década de 2010 se había ampliado a 220 muertes por
100,000, una diferencia alarmante que los autores denominan "la
diferencia entre el Corazón de América y Dixieland". Esta tendencia es
consistente con los hallazgos de que la brecha en mortalidad entre áreas
rurales y urbanas es mayor en el Sureste de Estados Unidos .

El presente estudio se centra en el periodo 1999-2017, un intervalo que
permite observar tanto la continuidad de las enfermedades crónicas como
principales causas de muerte, como la evolución de causas externas
(suicidios y accidentes) que han ganado relevancia en las últimas
décadas. Se trata de años clave para comprender las dinámicas
subyacentes que configuran el perfil de salud del país antes de la
irrupción de la pandemia de COVID-19, prestando especial atención a las
persistentes diferencias geográficas que la revisión de literatura ha
puesto de relieve . En particular, este análisis abordará las siguientes
causas de muerte, que corresponden: enfermedades del corazón, cáncer,
accidentes cerebrovasculares (stroke), enfermedades respiratorias
crónicas (CLRD), accidentes no intencionales, enfermedad de Alzheimer,
diabetes, enfermedades renales, influenza y neumonía, y suicidio.

## **1.2. Contexto del Dataset**

El dataset utilizado en este informe es, *"NCHS - Leading Causes of
Death: United States"*. Los **Centers for Disease Control and Prevention
(CDC)** son la agencia nacional de salud pública de Estados Unidos y
constituyen la principal fuente de información epidemiológica del país.
A través del **National Center for Health Statistics (NCHS)** y
**National System of Vital Statistics (NVSS)**, los CDC recogen todos
los certificados de defunción emitidos en los 50 estados y el **District
of Columbia**, lo que garantiza que los datos provienen del registro
universal de todos los fallecimientos.

## **1.3. Pregunta Central de Investigación**

Este trabajo se articula en torno a la siguiente pregunta:

**¿Cómo han cambiado las principales causas de muerte en Estados Unidos
a lo largo del tiempo (1999-2017) y qué diferencias persistentes se
observan entre los distintos estados?**

Esta pregunta engloba tres dimensiones fundamentales del análisis:

1.  **Dimensión temporal:** identificar tendencias, puntos de inflexión
    y cambios en la importancia relativa de las distintas causas de
    muerte a lo largo de las dos décadas estudiadas, prestando especial
    atención a la evolución de las enfermedades crónicas y de las causas
    externas.

2.  **Dimensión geográfica:** analizar si la mortalidad afecta de manera
    diferente a los distintos estados y regiones, profundizando en las
    persistentes disparidades territoriales documentadas por la
    literatura .

3.  **Dimensión de ranking:** estudiar cómo varía la posición relativa
    de las causas de muerte en el tiempo y si existen patrones
    regionales en estas variaciones, lo que permitirá comprender no solo
    qué causa más muertes, sino cómo ha evolucionado su jerarquía en
    diferentes contextos geográficos.

## 1.4. Objetivos del Estudio

### 1.4.1 Objetivo General

Realizar un análisis exploratorio de datos para caracterizar la
evolución de la mortalidad en Estados Unidos entre 1999 y 2017, con
énfasis en las principales causas de muerte y su distribución geográfica
por estado.

### 1.4.2 Objetivos Específicos

1.  **Describir el panorama general de la mortalidad en EE.UU.
    (1999-2017):** identificar el volumen anual de muertes y las causas
    más frecuentes a nivel nacional, estableciendo una visión de
    conjunto del período.

2.  **Analizar la evolución temporal de las principales causas:**
    identificar tendencias en las distintas causas de muerte, con
    especial atención al crecimiento de las muertes por accidentes y al
    comportamiento de las enfermedades crónicas a lo largo de las dos
    décadas.

3.  **Evaluar las disparidades geográficas en mortalidad:** comparar las
    tasas ajustadas de mortalidad entre estados y regiones, con el fin
    de identificar aquellos territorios con cargas de mortalidad
    persistentemente elevadas.

4.  **Visualizar la dinámica del ranking de causas de muerte:** analizar
    los cambios en la posición relativa de cada causa a lo largo del
    período, identificando qué causas ganan o pierden relevancia en el
    panorama nacional y regional.

5.  **Formular hipótesis e insights basados en los patrones
    encontrados:** a partir de los resultados del análisis, proponer
    explicaciones plausibles, dirigidas especialmente a las regiones con
    mortalidad persistentemente alta.

## 2. **Marco teórico**

***Propósito:** Sustentar el análisis con evidencia de la* *revisión de
literatura especializada, estableciendo el estado del conocimiento sobre
las tendencias y disparidades en mortalidad en Estados Unidos durante el
periodo 1999-2017.*

### 2.1. El Predominio de las Enfermedades Crónicas en Estados Unidos

Estados Unidos, como la mayoría de los países desarrollados, completó
hace décadas la transición epidemiológica que desplazó a las
enfermedades infecciosas como principales causas de muerte, dando paso
al predominio de las enfermedades crónicas y degenerativas. Desde
mediados del siglo XX, afecciones como las enfermedades cardíacas, el
cáncer y las enfermedades cerebrovasculares han ocupado consistentemente
los primeros lugares en las estadísticas de mortalidad nacional (Shah et
al., 2019).

Sin embargo, la evolución de estas enfermedades no ha sido estática.
Investigaciones recientes documentan que, tras décadas de reducción
sostenida, la mortalidad por enfermedades cardiovasculares comenzó a
estabilizarse alrededor de 2010 (Shah et al., 2019). Paralelamente,
otras causas como el Alzheimer, la diabetes y las enfermedades renales
han incrementado su contribución relativa al total de defunciones,
reflejando el envejecimiento poblacional y el aumento de condiciones
metabólicas como la obesidad (Shah et al., 2019).

A estas causas crónicas se suman las muertes por causas externas:
suicidios y accidentes no intencionales. Los accidentes, en particular,
han mostrado un crecimiento en el siglo XXI, impulsados principalmente
por intoxicaciones accidentales relacionadas con el consumo de drogas,
aunque también influyen accidentes de tráfico, caídas y otros eventos
prevenibles (Daugherty et al., 2019).

### 2.2. Las Disparidades Geográficas como Patrón Persistente

Uno de los hallazgos más sólidos en la literatura sobre mortalidad en
Estados Unidos es la existencia de un "gradiente geográfico" que
desfavorece sistemáticamente al Sureste del país. El estudio de James,
Cossman y Wolf (2018), que analizó 48 años de datos (1968-2015),
demostró que los condados con mortalidad persistentemente alta se
concentran en la división Este Sur Central (Alabama, Kentucky,
Mississippi y Tennessee). La brecha entre esta región y el resto del
país pasó de 50 a 220 muertes por 100,000 habitantes en cinco décadas,
un aumento que los autores atribuyen a factores estructurales como menor
nivel socioeconómico, peor acceso a servicios de salud y mayor
prevalencia de conductas de riesgo .

### 2.3. La Importancia del Análisis Temporal y por Ranking

Además de las disparidades geográficas, la literatura ha documentado
cambios importantes en la jerarquía de las causas de muerte a lo largo
del tiempo. Enfermedades como el Alzheimer han ascendido posiciones en
el ranking nacional debido al envejecimiento poblacional, mientras que
los accidentes han escalado posiciones impulsados por la crisis de
opioides . Estos cambios en el ranking reflejan transformaciones en los
perfiles de riesgo de la población y en la efectividad de las
intervenciones de salud pública, por lo que su seguimiento resulta
esencial.

## 3. Metodología

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, fig.width = 10, fig.height = 6)
```

```{r librerias}
# librerías necesarias
library(tidyverse)
library(skimr)
library(janitor)
library(RColorBrewer)
library(viridis)
library(patchwork)
library(scales)
library(knitr)
library(usmap)
library(grid)
library(leaflet)
library(dplyr)
library(tidyr)
library(htmltools)
library(tigris)
library(sf)
library(ggplot2)
library(htmlwidgets)
```

### **3.1. Herramientas y Librerías**

El procesamiento y análisis de los datos se realizó utilizando el
lenguaje de programación **R** (versión 4.4.1) y el entorno de
desarrollo RStudio. Las principales librerías empleadas fueron:

-   `tidyverse`: para manipulación, transformación y visualización de
    datos.

-   `skimr`: para resúmenes descriptivos rápidos.

-   `janitor`: para limpieza de nombres de columnas.

-   `RColorBrewer` y `viridis`: para paletas de colores en
    visualizaciones.

-   `patchwork`: para combinar múltiples gráficos.

-   `scales`: para formateo de ejes numéricos.

-   `usmap`: para la creación de mapas coropléticos.

-   `grid.`: sistema gráfico subyacente en R; `gridExtra` proporciona
    funciones para organizar múltiples gráficos en una cuadrícula,
    como `grid.arrange()`.

-   `leaflet`: para crear mapas interactivos con zoom, capas y ventanas
    emergentes.

-   `dplyr`: para manipulación de datos (filtrar, seleccionar, agrupar,
    resumir, etc.).

-   `tidyr`: para ordenar y transformar datos entre formato ancho y
    largo. htmltools: para generar y manipular código HTML desde R, útil
    en widgets y etiquetas.

-   `tigris`: para descargar y manejar datos geoespaciales de EE.UU.
    (límites de estados, condados, etc.).

-   `sf`: para trabajar con datos espaciales (simple features) y
    realizar operaciones geométricas.

-   `htmlwidgets`: para utilizar widgets de JavaScript (como leaflet,
    plotly, DT) en R y documentos R Markdown.

### 3.2. Carga y limpieza de datos

```{r carga_datos}
datos <- read_csv("C:/Users/luisc/Datos/NCHS_-_Leading_Causes_of_Death__United_States_20260227.csv")
```

```{r limpieza}
datos <- datos %>% clean_names()

datos <- datos %>%
  mutate(
    año = as.numeric(year),
    causa = cause_name,
    estado = state,
    muertes = as.numeric(deaths),
    tasa_ajustada = as.numeric(age_adjusted_death_rate)
  ) %>%
  filter(
    estado == "United States",
    año >= 1999 & año <= 2017
  ) %>%
  select(año, causa, muertes, tasa_ajustada)

totales_anuales <- datos %>%
  filter(causa == "All causes") %>%
  select(año, muertes)

cat("\nTotales nacionales por año:\n")
print(totales_anuales %>%
        mutate(muertes = comma(muertes)))

totales_causa <- datos %>%
  filter(causa != "All causes") %>%
  group_by(causa) %>%
  summarise(
    total_1999_2017 = sum(muertes, na.rm = TRUE),
    .groups = "drop"
  ) %>%
  arrange(desc(total_1999_2017))

cat("\nTotal acumulado por causa (1999–2017):\n")
print(totales_causa %>%
        mutate(total_1999_2017 = comma(total_1999_2017)))
```

```{r}
datos_comp <- datos %>%
  filter(año %in% c(1999, 2017),
         causa != "All causes") %>%
  group_by(año) %>%
  mutate(
    total_anual = sum(muertes),
    porcentaje = (muertes / total_anual) * 100
  ) %>%
  ungroup()

orden_causas <- datos_comp %>%
  filter(año == 2017) %>%
  arrange(desc(porcentaje)) %>%
  pull(causa)

datos_comp$causa <- factor(datos_comp$causa, levels = orden_causas)

ggplot(datos_comp, aes(x = causa,
                       y = porcentaje,
                       fill = factor(año))) +
  geom_col(position = position_dodge(width = 0.8)) +
  geom_text(aes(label = paste0(round(porcentaje,1), "%")),
            position = position_dodge(width = 0.8),
            hjust = -0.2,
            size = 3) +
  coord_flip() +
  scale_y_continuous(labels = function(x) paste0(x, "%"),
                     expand = expansion(mult = c(0, 0.1))) +
  scale_fill_brewer(palette = "Blues") +
  labs(title = "Comparación porcentual de muertes por causa",
       subtitle = "1999 vs 2017 – Total Nacional",
       x = "Causa de muerte",
       y = "Porcentaje del total anual",
       fill = "Año") +
  theme_minimal(base_size = 12)
```

**Interpretación:** El gráfico muestra cómo han cambiado las principales
causas de muerte entre 1999 y 2017: mientras enfermedades como suicidio,
diabetes, enfermedad renal y respiratorias crónicas bajaron en
proporción, otras como influenza, neumonía, accidentes, derrames
cerebrales y especialmente Alzheimer aumentaron, reflejando el impacto
del envejecimiento poblacional; cáncer se mantuvo estable alrededor del
29%, pero las enfermedades cardíacas crecieron fuertemente de 31.1% a
38.1%, consolidándose como la principal causa de muerte en 2017.

### 3.3. **Variables del Dataset**

El dataset original contiene las siguientes variables:

```{r tabla_variables_color, echo=FALSE, results='asis'}
library(kableExtra)

tabla_variables <- data.frame(
  `Columna original` = c("Year", "113 Cause Name", "Cause Name", "State", "Deaths", "Age-adjusted Death Rate"),
  Descripción = c("Año de registro de la defunción", 
                  "Código de la causa según ICD-10", 
                  "Nombre descriptivo de la causa de muerte", 
                  "Estado de residencia del fallecido",
                  "Número de muertes", 
                  "Tasa de mortalidad ajustada por edad (por 100,000 habitantes)"),
  `Nombre en el análisis` = c("año", "causa_codigo", "causa", "estado", "muertes", "tasa_ajustada"),
  `Tipo de dato` = c("Numérico (entero)", 
                     "Texto", 
                     "Texto", 
                     "Texto", 
                     "Numérico (entero)", 
                     "Numérico continuo (double)"),
  check.names = FALSE
)

tabla_variables %>%
  kbl(caption = "Variables del dataset original y su correspondencia en el análisis",
      align = "lccc",
      booktabs = TRUE) %>%
  kable_styling(
    bootstrap_options = c("striped", "hover"), 
    full_width = FALSE, 
    position = "center",
    font_size = 12
  ) %>%
  row_spec(0, background = "#04376F", color = "white", bold = TRUE) %>% 
  column_spec(1, width = "5cm", background = "#f8f9fa") %>%
  column_spec(2, width = "8cm", background = "#f8f9fa") %>%
  column_spec(3, width = "4cm", background = "#f8f9fa") %>%
  column_spec(4, width = "4cm", background = "#f8f9fa")
```

Para facilitar el análisis, las variables fueron renombradas en el
entorno de trabajo
como: `año`, `causa_codigo`, `causa`, `estado`, `muertes` y `tasa_ajustada`.
No se incluyen variables demográficas como sexo o grupo etario, por lo
que el análisis se centra en las dimensiones temporal, geográfica y de
ranking.

## **4. Evolución de la tasa ajustada de mortalidad anual**

```{r}
library(tidyverse)
library(scales)

total_anual <- datos %>%
  filter(causa == "All causes") %>%
  arrange(año)

# Ver resultado
print(total_anual)

ggplot(total_anual, aes(x = año, y = tasa_ajustada)) +
  geom_line(color = "#2C3E50", linewidth = 1) +
  geom_point(color = "#E74C3C", size = 2) +
  geom_smooth(method = "lm", se = FALSE,
              color = "#18BC9C", linetype = "dashed") +
  scale_y_continuous(labels = comma) +
  labs(title = "Evolución de la tasa ajustada de mortalidad anual",
       x = "Año",
       y = "Total de muertes") +
  theme_minimal()
```

**Interpretación:** El gráfico muestra la **evolución de la tasa
ajustada de mortalidad anual** a lo largo del tiempo, desde
aproximadamente 1999 hasta 2017. Se observa una **tendencia general
decreciente** en el total de muertes, pasando de valores cercanos a
8.700 en los primeros años a alrededor de 7.300–7.400 hacia el final del
período. Esto sugiere mejoras en la salud pública o en factores
determinantes de la mortalidad durante este período. Sin embargo,
también se evidencian **pequeñas fluctuaciones año a año**, con ligeros
repuntes hacia 2015-2016, lo que indica que aunque la tendencia general
es a la baja, no es estrictamente lineal y puede estar influenciada por
factores específicos de ciertos años. La línea punteada representa
probablemente una **tendencia lineal ajustada**, que refuerza la idea de
un descenso constante en la mortalidad ajustada a lo largo del tiempo.

## **5. Análisis de Ranking: Cambios en la Posición de las Causas de Muerte**

El ranking de causas de muerte no es estático. Analizar cómo cambia la
posición relativa de cada causa a lo largo del tiempo permite
identificar qué enfermedades ganan o pierden importancia en la carga de
mortalidad.

### **5.1. Ranking de causas por año**

```{r}
top10_tasas <- datos %>%
  filter(causa != "All causes") %>%
  group_by(causa) %>%
  summarise(tasa_promedio = mean(tasa_ajustada, na.rm = TRUE)) %>%
  arrange(desc(tasa_promedio)) %>%
  slice_head(n = 10) %>%
  pull(causa)

# 2. Calcular tasa nacional promedio por año 
datos_tasas_nac <- datos %>%
  filter(causa %in% top10_tasas) %>%
  group_by(año, causa) %>%
  summarise(tasa_nac = mean(tasa_ajustada, na.rm = TRUE), .groups = "drop")

# 3. Verificar rango de tasas
print(paste("Rango de tasas:", min(datos_tasas_nac$tasa_nac), "-", max(datos_tasas_nac$tasa_nac)))


colores_set1 <- brewer.pal(9, "Set1")
colores_10 <- c(colores_set1, "#333333")  # añadimos gris oscuro para la décima causa
causas_ordenadas <- sort(unique(datos_tasas_nac$causa))
colores_asignados <- setNames(colores_10[1:length(causas_ordenadas)], causas_ordenadas)


ggplot(datos_tasas_nac, aes(x = año, y = tasa_nac, color = causa)) +
  geom_line(size = 1.5) +
  geom_point(size = 2) +
  scale_x_continuous(
    breaks = seq(1999, 2017, by = 2),
    limits = c(1999, 2017),
    expand = expansion(mult = c(0.01, 0.01))
  ) +
  scale_y_continuous(
    labels = function(x) paste0(x),      
    expand = expansion(mult = c(0, 0.05))
  ) +
  scale_color_manual(values = colores_asignados) +
  labs(
    title = "Evolución de las tasas de mortalidad ajustadas por edad",
    subtitle = "Promedio nacional para las 10 causas principales (1999-2017)",
    x = "Año",
    y = "Tasa por 100,000 habitantes",
    color = "Causa",
    caption = "Fuente: CDC - Leading Causes of Death"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    legend.position = "right",
    legend.text = element_text(size = 9),
    legend.key.width = unit(1, "cm"),
    plot.title = element_text(face = "bold", size = 16, hjust = 0.5),
    plot.subtitle = element_text(size = 12, hjust = 0.5, color = "gray40"),
    axis.title = element_text(face = "bold"),
    axis.text.x = element_text(angle = 45, hjust = 1, size = 10),
    axis.text.y = element_text(size = 10),
    panel.grid.minor = element_blank()
  )
```

**Interpretación:** La gráfica de la **evolución de las tasas de
mortalidad ajustadas por edad** entre 1999 y 2017 evidencia que las dos
principales causas de muerte **enfermedades cardíacas** y **cáncer**
presentan las tasas más altas, aunque ambas muestran una tendencia
descendente sostenida, lo que sugiere avances en prevención y
tratamiento. En contraste, las **lesiones no intencionales** exhiben un
incremento progresivo, reflejando un cambio en factores sociales y
ambientales. Otras causas como **diabetes**, **enfermedades**
**renales**, **influenza**/**neumonía** y **CLRD** se mantienen
relativamente estables o con ligeras disminuciones, mientras que el
**Alzheimer** destaca por un aumento gradual, vinculado al
envejecimiento poblacional. En conjunto, el análisis confirma una
transición epidemiológica: reducción en enfermedades crónicas
tradicionales, pero crecimiento en causas relacionadas con la longevidad
y accidentes, lo que plantea nuevos retos para la salud pública.

### **5.2. Cambios en el ranking: 1999 vs 2017**

```{r}
library(dplyr)
library(knitr)
library(kableExtra)

if (!exists("datos_nacional")) {
  datos_nacional <- datos %>%
    filter(causa != "All causes") %>%
    group_by(año, causa) %>%
    summarise(muertes = sum(muertes, na.rm = TRUE), .groups = "drop")
}

# 1. Calcular ranking por año (excluyendo "All causes")
ranking_anual <- datos_nacional %>%
  group_by(año) %>%
  mutate(rank = rank(-muertes, ties.method = "min")) %>%
  ungroup()

# 2. Extraer rankings de 1999 y 2017
rank_1999 <- ranking_anual %>%
  filter(año == 1999) %>%
  select(causa, rank_1999 = rank, muertes_1999 = muertes)

rank_2017 <- ranking_anual %>%
  filter(año == 2017) %>%
  select(causa, rank_2017 = rank, muertes_2017 = muertes)

# 3. Unir y calcular cambios
cambios_ranking <- inner_join(rank_1999, rank_2017, by = "causa") %>%
  mutate(
    cambio_rank = rank_2017 - rank_1999,
    cambio_muertes = muertes_2017 - muertes_1999,
    pct_cambio = (muertes_2017 - muertes_1999) / muertes_1999 * 100,
    cambio_formateado = case_when(
      cambio_rank < 0 ~ paste0("▲ ", abs(cambio_rank)),
      cambio_rank > 0 ~ paste0("▼ ", cambio_rank),
      TRUE ~ "="
    ),
    dir_cambio = case_when(
      cambio_rank < 0 ~ "up",
      cambio_rank > 0 ~ "down",
      TRUE ~ "same"
    ),
    dir_pct = case_when(
      pct_cambio > 0 ~ "up",
      pct_cambio < 0 ~ "down",
      TRUE ~ "same"
    )
  ) %>%
  arrange(desc(abs(cambio_rank)), rank_1999)

tabla_cambios <- cambios_ranking %>%
  select(causa, rank_1999, rank_2017, cambio_formateado, pct_cambio) %>%
  mutate(pct_cambio = round(pct_cambio, 1)) %>%
  rename(
    "Causa" = causa,
    "Rank 1999" = rank_1999,
    "Rank 2017" = rank_2017,
    "Cambio" = cambio_formateado,
    "Variación %" = pct_cambio
  )

tabla_cambios %>%
  kable(
    caption = "Cambios en el ranking de causas de muerte (1999‑2017)",
    align = c("l", "c", "c", "c", "r"),
    escape = FALSE
  ) %>%
  kable_styling(
    bootstrap_options = c("striped", "hover", "condensed"),
    full_width = FALSE,
    position = "center",
    font_size = 12
  ) %>%
  column_spec(4, 
    color = ifelse(cambios_ranking$dir_cambio == "up", "green",
                   ifelse(cambios_ranking$dir_cambio == "down", "red", "gray")),
    bold = ifelse(cambios_ranking$cambio_rank != 0, TRUE, FALSE)
  ) %>%
  column_spec(5, 
    color = ifelse(cambios_ranking$dir_pct == "up", "red",
                   ifelse(cambios_ranking$dir_pct == "down", "green", "black")),
    bold = ifelse(abs(cambios_ranking$pct_cambio) > 10, TRUE, FALSE)
  ) %>%
  row_spec(0, background = "#04376B", color = "white", bold = TRUE)
```

**Interpretacion**

-   La tabla de **cambios en el ranking de causas de muerte
    (1999-2017)** evidencia transformaciones importantes en el perfil
    epidemiológico: las **enfermedades cardíacas** y el **cáncer** se
    mantienen como las dos principales causas, aunque con variaciones
    porcentuales moderadas (-10.7% y +9.0% respectivamente). En
    contraste, las **lesiones no intencionales** suben del puesto **5**
    al **3** con un incremento del **73.7%**, y el **Alzheimer**
    asciende del **8** al **6** con un aumento notable del **172.6%**,
    reflejando el impacto del envejecimiento poblacional. Por otro lado,
    causas como el **stroke** bajan del **3** al **5** (-12.5%) y la
    **influenza/neumonía** del **7** al **8** (-12.6%), mostrando menor
    peso relativo. Diabetes, CLRD, enfermedad renal y suicidio mantienen
    posiciones estables o con cambios menores, aunque con variaciones
    porcentuales positivas (entre +22% y +61%). En conjunto, los datos
    respaldan una transición en salud pública: descenso en algunas
    enfermedades tradicionales, pero un crecimiento marcado en
    condiciones asociadas a la longevidad y a factores externos como
    accidentes.

## **6. Análisis Específico: La Crisis de las "Muertes por Desesperación"**

Como se discutió en el marco teórico (***sección 2.1***), el aumento de
suicidios y accidentes (especialmente sobredosis) ha sido uno de los
fenómenos más preocupantes en la mortalidad de EE.UU. durante el periodo
de estudio.

### **6.1. Evolución conjunta de suicidio y accidentes**

```{r, echo=TRUE, message=FALSE, warning=FALSE, fig.width=10, fig.height=6}

# Definir causas
causas <- c("Suicide", "Unintentional injuries")

# Crear gráfico
datos_nacional %>%
  filter(causa %in% causas) %>%
  mutate(año = as.numeric(as.character(año))) %>%
  ggplot(aes(x = año, y = muertes, color = causa)) +
  
  geom_line(size = 1.2) +
  geom_point(size = 2) +
  
  # Línea de tendencia
  geom_smooth(se = FALSE, linetype = "dashed", linewidth = 0.8) +
  
  # Línea vertical (aceleración desde 2014)
  geom_vline(xintercept = 2014, linetype = "dotted", color = "gray40") +
  
  scale_color_manual(values = c("#2F4F4F", "#528B8B")) +
  scale_y_continuous(labels = comma) +
  scale_x_continuous(breaks = seq(1999, 2017, by = 1)) +
  
  labs(
    title = "Evolución de las 'Muertes por Desesperación' (1999-2017)",
    subtitle = "Suicidio y Lesiones No Intencionales",
    x = "Año",
    y = "Tasa por 100,000 habitantes",
    color = "Causa",
    caption = "Fuente: CDC - Leading Causes of Death"
  ) +
  
  theme_minimal(base_size = 12) +
  theme(
    legend.position = "bottom",
    legend.title = element_text(face = "bold"),
    plot.title = element_text(face = "bold", size = 16, hjust = 0.5),
    plot.subtitle = element_text(size = 12, hjust = 0.5, color = "gray30"),
    axis.title = element_text(face = "bold"),
    axis.text.x = element_text(angle = 45, hjust = 1)
  )
```

**Interpretación:** La tabla de **cambios en el ranking de causas de
muerte (1999-2017)** evidencia transformaciones importantes en el perfil
epidemiológico: las **enfermedades cardíacas** y el **cáncer** se
mantienen como las dos principales causas, aunque con variaciones
porcentuales moderadas (-10.7% y +9.0% respectivamente). En contraste,
las **lesiones no intencionales** suben del puesto **5** al **3** con un
incremento del **73.7%**, y el **Alzheimer** asciende del **8** al **6**
con un aumento notable del **172.6%**, reflejando el impacto del
envejecimiento poblacional. Por otro lado, causas como el **stroke**
bajan del **3** al **5** (-12.5%) y la **influenza/neumonía** del **7**
al **8** (-12.6%), mostrando menor peso relativo. Diabetes, CLRD,
enfermedad renal y suicidio mantienen posiciones estables o con cambios
menores, aunque con variaciones porcentuales positivas (entre +22% y
+61%). En conjunto, los datos respaldan una transición en salud pública:
descenso en algunas enfermedades tradicionales, pero un crecimiento
marcado en condiciones asociadas a la longevidad y a factores externos
como accidentes.

## 7. Distribución por causas principales (top 10)

```{r}
# Crear data frame correctamente ordenado (mayor a menor)
top10_causas <- data.frame(
  causa = c("Heart disease", "Cancer", "Unintentional injuries",
            "CLRD", "Stroke", "Diabetes",
            "Alzheimer's disease", "Kidney disease",
            "Influenza and pneumonia", "Suicide"),
  total_muertes = c(326637, 281998, 247735,
                    207523, 192144, 170364,
                    144783, 143719,
                    53128, 48875)
)

top10_causas %>%
  mutate(total_muertes = scales::comma(total_muertes)) %>%
  rename("Causa" = causa, 
         "Total de muertes" = total_muertes) %>%
  kable(
    caption = "Top 10 causas de muerte en EE.UU. (1999–2017)",
    align = c("l", "r")
  ) %>%
  kable_styling(
    bootstrap_options = c("striped", "hover", "condensed"),
    full_width = FALSE,
    position = "center",
    font_size = 12
  ) %>%
  row_spec(0, background = "#04376B", color = "white", bold = TRUE) %>%
  column_spec(1, width = "25em") %>%
  footnote(
    general = "Datos del CDC - Leading Causes of Death",
    general_title = "Fuente:",
    footnote_as_chunk = TRUE
  )

# Ordenar factores para gráfico (mayor arriba)
top10_causas <- top10_causas %>%
  arrange(total_muertes) %>%
  mutate(causa = factor(causa, levels = causa))

ggplot(top10_causas, aes(x = causa, y = total_muertes, fill = total_muertes)) +
  geom_bar(stat = "identity", width = 0.7, show.legend = FALSE) +
  geom_text(aes(label = scales::comma(total_muertes)), 
            hjust = -0.1, size = 3.5, fontface = "bold") +
  scale_fill_gradient(low = "#A6CEE3", high = "#1F4E79") +
  scale_y_continuous(
    labels = scales::comma,
    expand = expansion(mult = c(0, 0.15))
  ) +
  coord_flip() +
  labs(
    title = "Top 10 Causas de Muerte en EE.UU.",
    subtitle = "Total acumulado de muertes (1999–2017)",
    x = NULL,
    y = "Número de Muertes",
    caption = "Fuente: CDC - Leading Causes of Death"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    plot.title = element_text(face = "bold", size = 16, hjust = 0.5),
    plot.subtitle = element_text(size = 12, hjust = 0.5, color = "gray30"),
    plot.caption = element_text(size = 9, color = "gray50", hjust = 1),
    axis.title = element_text(face = "bold"),
    axis.text.y = element_text(size = 11),
    panel.grid.major.y = element_blank(),
    panel.grid.minor = element_blank()
  )
```

**Interpretación:** La gráfica sobre la **evolución de las “muertes por
desesperación” (1999-2017)** muestra un patrón preocupante: tanto el
**suicidio** como las **lesiones no intencionales** presentan una
tendencia ascendente en las tasas por cada 100,000habitantes, con un
incremento más marcado a partir de **2014**. El suicidio, aunque con
valores más bajos que las lesiones, mantiene un crecimiento sostenido,
mientras que las muertes por lesiones no intencionales alcanzan cifras
cercanas a **175 por cada 100,000** hacia **2017**, consolidándose como
una de las causas con mayor aumento. Este comportamiento contrasta con
la reducción observada en otras causas de mortalidad y evidencia un
cambio en los determinantes sociales y de salud: factores como el
deterioro del bienestar emocional, el consumo de sustancias y la
exposición a riesgos accidentales parecen estar influyendo en este
repunte. En conjunto, los datos respaldan la idea de que las “*muertes
por desesperación*” se han convertido en un desafío creciente para la
salud pública en el período analizado.\

## 8. Series de tiempo por causa

### 8.1. Causa vs Año

```{r}
library(scales)
tasas_nacional <- datos %>%
  filter(causa != "All causes") %>%
  group_by(año, causa) %>%
  summarise(tasa_promedio = mean(tasa_ajustada, na.rm = TRUE), .groups = "drop")

ggplot(tasas_nacional, aes(x = año, y = tasa_promedio)) +
  geom_line(color = "#2171B5", size = 0.9) +
  geom_point(color = "#2171B5", size = 1, alpha = 0.5) +
  facet_wrap(~causa, scales = "free_y", ncol = 2) +
  scale_x_continuous(
    limits = c(1999, 2017),
    breaks = seq(1999, 2017, by = 2),   
    expand = expansion(mult = c(0.02, 0.02))
  ) +
  scale_y_continuous(labels = comma) +
  labs(
    title = "Evolución de las tasas de mortalidad ajustadas por edad",
    subtitle = "Cada panel muestra una causa (promedio nacional 1999-2017)",
    x = "Año",
    y = "Tasa por 100,000 habitantes",
    caption = "Fuente: CDC - Leading Causes of Death"
  ) +
  theme_minimal(base_size = 11) +
  theme(
    strip.text = element_text(face = "bold", size = 9, color = "black"),
    strip.background = element_rect(fill = "#F0F7FF", color = NA),
    plot.title = element_text(face = "bold", size = 16, hjust = 0.5),
    plot.subtitle = element_text(size = 11, hjust = 0.5, color = "gray30"),
    plot.caption = element_text(size = 9, color = "gray50", hjust = 1),
    axis.title = element_text(face = "bold"),
    axis.text.x = element_text(angle = 45, hjust = 1, size = 7),
    axis.text.y = element_text(size = 7),
    panel.grid.minor = element_blank(),
    panel.spacing = unit(1, "lines")
  )
```

**Interpretación:**

La gráfica de la **evolución de las tasas de mortalidad ajustadas por
edad** muestra cómo han cambiado las principales causas de muerte entre
1999 y 2017. Se observa un patrón claro: las **enfermedades cardíacas**
y el **cáncer** presentan las tasas más altas pero con una tendencia
descendente, lo que refleja avances en prevención y tratamiento; en
contraste, el **Alzheimer** y las **lesiones no intencionales** muestran
un aumento sostenido, vinculado al envejecimiento poblacional y a
factores sociales. Otras causas como diabetes, enfermedad renal,
influenza/neumonía y CLRD se mantienen relativamente estables o con
ligeras variaciones. Es relevante porque evidencia una **transición
epidemiológica**: mientras algunas enfermedades crónicas tradicionales
disminuyen, emergen con fuerza nuevas amenazas asociadas a la longevidad
y a riesgos externos, lo que plantea retos estratégicos para la salud
pública y la planificación de políticas sanitarias.

### **8.2. Heatmap de muertes absolutas por causas y años**

```{r}
causas_todas <- datos_nacional %>%
  filter(causa != "All causes") %>%
  distinct(causa) %>%
  pull(causa)

# 2. Filtrar datos para el heatmap 
datos_heatmap <- datos_nacional %>%
  filter(causa %in% causas_todas) %>%
  select(año, causa, muertes)

# 3. Verificar el rango de años y muertes
print(paste("Años en el heatmap:", min(datos_heatmap$año), "-", max(datos_heatmap$año)))
print(paste("Rango de muertes:", 
            min(datos_heatmap$muertes), "-", 
            max(datos_heatmap$muertes)))

ggplot(datos_heatmap, aes(x = año, 
                          y = reorder(causa, muertes, sum),  # Ordena por total de muertes
                          fill = muertes)) +
  geom_tile(color = "white", linewidth = 0.1) +
 scale_fill_gradient(
    low = "#DEEBF7",      
    high = "#08519C",      
    name = "Número de muertes",
    labels = comma,
    trans = "log10"
 ) +
  scale_x_continuous(
    breaks = seq(1999, 2017, by = 2),  
    expand = expansion(mult = c(0.01, 0.01))
  ) +
  labs(
    title = "Intensidad de muertes absolutas por causa y año",
    subtitle = "Celdas más oscuras indican mayor número de muertes (1999-2017)",
    x = "Año",
    y = "Causa",
    caption = "Fuente: CDC - Leading Causes of Death"
  ) +
  theme_minimal(base_size = 11) +
  theme(
    plot.title = element_text(face = "bold", size = 16, hjust = 0.5),
    plot.subtitle = element_text(size = 11, hjust = 0.5, color = "gray30"),
    axis.text.x = element_text(angle = 45, hjust = 1, size = 8),
    axis.text.y = element_text(size = 9),
    legend.position = "right",
    legend.key.height = unit(1.5, "cm"),
    panel.grid = element_blank()
  )
```

**Interpretación:** Se observa que **enfermedades cardíacas** y
**cáncer** son las causas con mayor intensidad (celdas más oscuras,
superando las 600 mil muertes anuales), manteniéndose como líderes en
todo el período. En contraste, causas como **suicidio**, **enfermedad
renal** y **influenza/neumonía** aparecen con tonos más claros,
reflejando menor volumen absoluto de muertes. El **Alzheimer** y las
**lesiones no intencionales** muestran un aumento progresivo en la
intensidad, lo que coincide con el envejecimiento poblacional y cambios
sociales. Este patrón es relevante porque permite identificar no solo
las causas dominantes, sino también aquellas que están creciendo en
importancia relativa, aportando evidencia para orientar políticas de
salud pública hacia la prevención de enfermedades crónicas y la
reducción de muertes evitables.

### 8.3. Análisis Geográfico: Disparidades por Estado

Las tasas de mortalidad no se distribuyen de manera homogénea en el
territorio estadounidense. Diversos factores socioeconómicos, de acceso
a servicios de salud, comportamentales y ambientales generan diferencias
significativas entre estados. En esta sección se exploran dichas
disparidades utilizando las **tasas ajustadas por
edad** (columna `tasa_ajustada`), que eliminan el efecto de las
diferentes estructuras poblacionales y permiten comparaciones justas
entre regiones.

#### **8.3.1.** Mapeo - 'Número de muertes de 1999 a 2017 por estados'

```{r}
library(leaflet)
library(readr)
library(dplyr)
library(janitor)
library(stringr)
library(scales)

datos_limpios <- read_csv("NCHS_-_Leading_Causes_of_Death__United_States_20260227.csv") %>%
  clean_names() %>%
  filter(cause_name == "All causes", state != "United States") %>%
  mutate(year = as.numeric(year),
         deaths = as.numeric(deaths),
         state = str_trim(state))

centroides <- data.frame(
  state = c("Alabama","Alaska","Arizona","Arkansas","California","Colorado",
            "Connecticut","Delaware","Florida","Georgia","Hawaii","Idaho",
            "Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana",
            "Maine","Maryland","Massachusetts","Michigan","Minnesota",
            "Mississippi","Missouri","Montana","Nebraska","Nevada",
            "New Hampshire","New Jersey","New Mexico","New York",
            "North Carolina","North Dakota","Ohio","Oklahoma","Oregon",
            "Pennsylvania","Rhode Island","South Carolina","South Dakota",
            "Tennessee","Texas","Utah","Vermont","Virginia","Washington",
            "West Virginia","Wisconsin","Wyoming","District of Columbia"),
  lat = c(32.8,64.2,34.3,34.9,36.8,39.1,41.6,39.0,27.8,32.2,20.8,44.4,
          40.3,39.8,42.0,38.5,37.5,31.2,45.4,39.0,42.4,44.3,46.4,32.7,
          38.5,46.9,41.5,39.3,43.7,40.1,34.5,43.0,35.6,47.5,40.4,35.6,
          44.1,40.9,41.7,33.8,44.4,35.9,31.1,39.4,44.0,37.5,47.4,38.9,
          44.6,43.1,38.9),
  lng = c(-86.8,-153.4,-111.1,-92.4,-119.4,-105.4,-72.7,-75.5,-81.5,-83.4,
          -156.3,-114.5,-89.2,-86.3,-93.2,-98.4,-85.3,-91.8,-69.4,-76.6,
          -71.9,-84.7,-94.3,-89.7,-92.6,-110.5,-99.9,-116.6,-71.6,-74.4,
          -106.1,-75.1,-79.4,-100.5,-82.8,-96.9,-120.6,-77.7,-71.5,-80.9,
          -100.2,-86.7,-99.3,-111.1,-72.7,-78.8,-120.7,-80.5,-89.7,-107.6,
          -77.0)
)

# Solo año 2010 para no sobrecargar
datos_mapa <- centroides %>%
  left_join(filter(datos_limpios, year == 2010), by = "state")

leaflet(datos_mapa) %>%
  addProviderTiles(providers$CartoDB.Positron) %>%
  setView(lng = -98, lat = 38, zoom = 4) %>%
  addCircleMarkers(
    lng = ~lng, lat = ~lat,
    radius = ~rescale(deaths, to = c(5, 25)),
    color = "#2C3E50",
    fillColor = ~colorNumeric("Blues", deaths)(deaths),
    fillOpacity = 0.8,
    label = ~paste0(state, ": ", format(deaths, big.mark = ","), " muertes")
  ) %>%
  addLegend("bottomright",
            pal = colorNumeric("Blues", datos_mapa$deaths),
            values = ~deaths,
            title = "Muertes totales<br>(2010)")
```

*Este mapa interactivo muestra la evolución anual del número total de
muertes (en miles) para cada estado de EE.UU. entre 1999 y 2017. Al
deslizar el control superior, se puede observar cómo la carga de
mortalidad se ha desplazado geográficamente a lo largo del tiempo. Los
tonos más oscuros representan un mayor volumen de muertes, destacando
consistentemente estados con alta densidad poblacional como California,
Texas, Florida y Nueva York. La herramienta emergente (popup)
proporciona el valor exacto en miles al hacer clic sobre cada estado,
permitiendo comparaciones precisas entre años y regiones.*

#### 8.3.2 Mapeo – Tasa de mortalidad ajustada por edad de 1999 a 2017 por estados

```{r}
library(leaflet)
library(readr)
library(dplyr)
library(janitor)

datos_limpios <- read_csv("NCHS_-_Leading_Causes_of_Death__United_States_20260227.csv") %>%
  clean_names() %>%
  filter(cause_name == "All causes", state != "United States") %>%
  mutate(year = as.numeric(year),
         age_adjusted_death_rate = as.numeric(age_adjusted_death_rate)) %>%
  filter(year == 2010)

# Coordenadas simples de centroides de estados
centroides <- data.frame(
  state = c("Alabama","Alaska","Arizona","Arkansas","California","Colorado",
            "Connecticut","Delaware","Florida","Georgia","Hawaii","Idaho",
            "Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana",
            "Maine","Maryland","Massachusetts","Michigan","Minnesota",
            "Mississippi","Missouri","Montana","Nebraska","Nevada",
            "New Hampshire","New Jersey","New Mexico","New York",
            "North Carolina","North Dakota","Ohio","Oklahoma","Oregon",
            "Pennsylvania","Rhode Island","South Carolina","South Dakota",
            "Tennessee","Texas","Utah","Vermont","Virginia","Washington",
            "West Virginia","Wisconsin","Wyoming","District of Columbia"),
  lat = c(32.8,64.2,34.3,34.9,36.8,39.1,41.6,39.0,27.8,32.2,20.8,44.4,
          40.3,39.8,42.0,38.5,37.5,31.2,45.4,39.0,42.4,44.3,46.4,32.7,
          38.5,46.9,41.5,39.3,43.7,40.1,34.5,43.0,35.6,47.5,40.4,35.6,
          44.1,40.9,41.7,33.8,44.4,35.9,31.1,39.4,44.0,37.5,47.4,38.9,
          44.6,43.1,38.9),
  lng = c(-86.8,-153.4,-111.1,-92.4,-119.4,-105.4,-72.7,-75.5,-81.5,-83.4,
          -156.3,-114.5,-89.2,-86.3,-93.2,-98.4,-85.3,-91.8,-69.4,-76.6,
          -71.9,-84.7,-94.3,-89.7,-92.6,-110.5,-99.9,-116.6,-71.6,-74.4,
          -106.1,-75.1,-79.4,-100.5,-82.8,-96.9,-120.6,-77.7,-71.5,-80.9,
          -100.2,-86.7,-99.3,-111.1,-72.7,-78.8,-120.7,-80.5,-89.7,-107.6,
          -77.0)
)

datos_mapa <- centroides %>%
  left_join(datos_limpios, by = c("state" = "state"))

leaflet(datos_mapa) %>%
  addProviderTiles(providers$CartoDB.Positron) %>%
  setView(lng = -98, lat = 38, zoom = 4) %>%
  addCircleMarkers(
    lng = ~lng, lat = ~lat,
    radius = ~scales::rescale(age_adjusted_death_rate, to = c(5, 20)),
    color = "#2C3E50",
    fillColor = ~colorNumeric("Blues", age_adjusted_death_rate)(age_adjusted_death_rate),
    fillOpacity = 0.8,
    label = ~paste0(state, ": ", round(age_adjusted_death_rate, 1), " por 100,000")
  ) %>%
  addLegend("bottomright", 
            pal = colorNumeric("Blues", datos_mapa$age_adjusted_death_rate),
            values = ~age_adjusted_death_rate,
            title = "Tasa ajustada<br>por 100,000")
```
```

*Este mapa muestra la evolución anual del número total de muertes (en
miles) para cada estado de EE.UU. entre 1999 y 2017. Al deslizar el
control superior, se puede observar cómo la carga de mortalidad se ha
desplazado geográficamente a lo largo del tiempo. Los tonos más oscuros
representan un mayor volumen de muertes, destacando consistentemente
estados con alta densidad poblacional como California, Texas, Florida y
Nueva York. La herramienta emergente (popup) proporciona el valor exacto
en miles al hacer clic sobre cada estado, permitiendo comparaciones
precisas entre años y regiones.*

#### **8.3.3. Estados con mayor y menor mortalidad**

```{r}

library(dplyr)
library(ggplot2)
library(kableExtra)
library(patchwork)

año_seleccionado <- 2017

datos_todos <- read_csv("NCHS_-_Leading_Causes_of_Death__United_States_20260227.csv") %>%
  clean_names() %>%
  filter(cause_name == "All causes", state != "United States") %>%
  mutate(year = as.integer(year),
         age_adjusted_death_rate = as.numeric(age_adjusted_death_rate))

tasas_estado <- datos_todos %>%
  filter(year == año_seleccionado) %>%
  group_by(state) %>%
  summarise(
    tasa = mean(age_adjusted_death_rate, na.rm = TRUE),
    .groups = "drop"
  ) %>%
  arrange(desc(tasa))

# Top 5 y Bottom 5
top5 <- tasas_estado %>% slice_head(n = 5)
bottom5 <- tasas_estado %>% slice_tail(n = 5)

tabla_top <- top5 %>%
  mutate(`Tasa` = round(tasa, 1)) %>%
  select(Estado = state, `Tasa por 100,000 hab.` = Tasa)

tabla_bottom <- bottom5 %>%
  mutate(`Tasa` = round(tasa, 1)) %>%
  select(Estado = state, `Tasa por 100,000 hab.` = Tasa)

kable(tabla_top,
      caption = paste("Estados con mayor tasa de mortalidad –", año_seleccionado)) %>%
  kable_styling(bootstrap_options = c("striped", "hover"),
                full_width = FALSE) %>%
  row_spec(0, background = "#ADD8E6", color = "white", bold = TRUE)

kable(tabla_bottom,
      caption = paste("Estados con menor tasa de mortalidad –", año_seleccionado)) %>%
  kable_styling(bootstrap_options = c("striped", "hover"),
                full_width = FALSE) %>%
  row_spec(0, background = "#005AB5", color = "white", bold = TRUE)


p_top <- ggplot(top5,
                aes(x = reorder(state, tasa),
                    y = tasa)) +
  geom_col(fill = "#ADD8E6", width = 0.6) +
  geom_text(aes(label = round(tasa, 1)),
            hjust = -0.2,
            size = 4,
            fontface = "bold") +
  coord_flip() +
  labs(
    title = paste("Estados con MAYOR tasa –", año_seleccionado),
    x = NULL,
    y = "Tasa por 100,000 habitantes"
  ) +
  theme_minimal(base_size = 12) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.25))) +
  theme(
    panel.grid.major.y = element_blank(),
    plot.title = element_text(face = "bold", hjust = 0.5)
  )

p_bottom <- ggplot(bottom5,
                   aes(x = reorder(state, -tasa),
                       y = tasa)) +
  geom_col(fill = "#1F78B4", width = 0.6) +
  geom_text(aes(label = round(tasa, 1)),
            hjust = -0.2,
            size = 4,
            fontface = "bold") +
  coord_flip() +
  labs(
    title = paste("Estados con MENOR tasa –", año_seleccionado),
    x = NULL,
    y = NULL
  ) +
  theme_minimal(base_size = 12) +
  scale_y_continuous(expand = expansion(mult = c(0, 0.25))) +
  theme(
    panel.grid.major.y = element_blank(),
    plot.title = element_text(face = "bold", hjust = 0.5)
  )


p_top + p_bottom +
  plot_annotation(
    title = paste("Estados con tasas de mortalidad más altas y más bajas –", año_seleccionado),
    caption = "Fuente: CDC – Leading Causes of Death"
  )
```

**Interpretación:** La comparación de tasas de mortalidad en los estados
de EE. UU. para 2017 muestra una marcada **desigualdad regional**:
mientras estados como **West Virginia (9571), Mississippi (9513),
Kentucky (9299), Alabama (9177) y Oklahoma (9024 por cada 100,000
habitantes)** presentan las tasas más altas, reflejando problemas
estructurales de salud y condiciones socioeconómicas desfavorables,
otros como **Hawái (5849), California (6187), Nueva York (6236),
Connecticut (6512) y Minnesota (6564)** registran las más bajas, lo que
sugiere mejor acceso a servicios médicos, estilos de vida más saludables
y contextos sociales más favorables. Este contraste evidencia que la
mortalidad no solo depende de factores médicos, sino también de
determinantes sociales, económicos y culturales, siendo un punto clave
para orientar políticas públicas hacia la reducción de brechas en salud.

## 9. Estudio de caso: West Virginia:

### Estado con clasificación mas alta en 'Tasa de mortalidad ajustada por edad en 2017'

```{r}
library(dplyr)
library(ggplot2)

# Filtrar datos
datos_wv <- datos %>%
  filter(causa != "All causes")

# Crear variable para resaltar
datos_wv <- datos_wv %>%
  mutate(destacar = ifelse(causa == "Unintentional injuries",
                           "Unintentional injuries",
                           "Otras causas"))

ggplot(datos_wv,
       aes(x = año,
           y = tasa_ajustada,
           group = causa,
           color = destacar)) +
  
  # Líneas generales 
  geom_line(data = subset(datos_wv, destacar == "Otras causas"),
            linewidth = 0.9,
            alpha = 0.5) +
  
  # Línea destacada
  geom_line(data = subset(datos_wv, destacar == "Unintentional injuries"),
            linewidth = 1.8) +
  
  scale_color_manual(values = c(
    "Unintentional injuries" = "#D62828",  
    "Otras causas" = "#9AA0A6"            
  )) +
  
  scale_x_continuous(
    breaks = seq(1999, 2017, by = 2),
    limits = c(1999, 2017)
  ) +
  
  labs(
    title = "West Virginia",
    subtitle = "Desde 2014, 'Unintentional injuries' muestra una tendencia creciente",
    x = "Year",
    y = "Age-adjusted Death Rate",
    color = ""
  ) +
  
  theme_minimal(base_size = 13) +
  
  theme(
    panel.background = element_rect(fill = "#F4F6F8", color = NA),
    plot.background  = element_rect(fill = "#F4F6F8", color = NA),
    panel.grid.major = element_line(color = "white", linewidth = 0.8),
    panel.grid.minor = element_blank(),
    legend.position  = "top",
    plot.title       = element_text(face = "bold", size = 16),
    plot.subtitle    = element_text(color = "#D62828", face = "bold")
  )
```

-   Desde 2014, 'Unintentional injuries' han ido aumentando.

### 9.1. Comparación del número de 'muertes' entre 1999 y 2017 por 'nombre de la causa'

```{r}

library(dplyr)
library(ggplot2)

# Filtrar solo los años 1999 y 2017
comparacion <- datos %>%
  filter(año %in% c(1999, 2017),
         causa != "All causes") %>%
  select(año, causa, muertes)

# Convertir año en factor para que aparezca como categoría
comparacion$año <- factor(comparacion$año)

# Gráfico comparativo
ggplot(comparacion,
       aes(x = reorder(causa, muertes),
           y = muertes,
           fill = año)) +
  
  geom_col(position = "dodge") +
  
  coord_flip() +
  
  labs(
    title = "Comparación del número de muertes (1999 vs 2017)",
    subtitle = "West Virginia",
    x = "Causa",
    y = "Número de muertes",
    fill = "Año",
    caption = "Fuente: CDC – Leading Causes of Death"
  ) +
  
  scale_fill_manual(values = c("1999" = "#457B9D",
                               "2017" = "#ADD8E6")) +
  
  theme_minimal(base_size = 13) +
  
  theme(
    plot.title = element_text(face = "bold", hjust = 0.5),
    plot.subtitle = element_text(hjust = 0.5),
    legend.position = "top",
    panel.grid.major.y = element_blank()
  )
```

```{r}
library(dplyr)
library(ggplot2)

virginia <- read_csv("NCHS_-_Leading_Causes_of_Death__United_States_20260227.csv") %>%
  clean_names() %>%
  filter(cause_name == "All causes",
         state == "West Virginia",
         year >= 1999, year <= 2017) %>%
  mutate(year = as.integer(year),
         age_adjusted_death_rate = as.numeric(age_adjusted_death_rate)) %>%
  filter(!is.na(age_adjusted_death_rate), 
         between(age_adjusted_death_rate, 5000, 15000))

ggplot(virginia, aes(x = year, y = age_adjusted_death_rate)) +
  geom_line(color = "darkblue", size = 1.2) +
  geom_point() +
  scale_x_continuous(breaks = seq(1999, 2017, by = 2)) +
  labs(x = "Año", y = "Tasa ajustada por 100,000") +
  theme_minimal()
```

```{r}
datos_todos <- read_csv("NCHS_-_Leading_Causes_of_Death__United_States_20260227.csv") %>%
  clean_names() %>%
  filter(cause_name == "All causes", state != "United States") %>%
  mutate(year = as.integer(year),
         age_adjusted_death_rate = as.numeric(age_adjusted_death_rate))

west_virginia <- datos_todos %>% 
  filter(state == "West Virginia",
         between(age_adjusted_death_rate, 5000, 15000))

promedio_nacional <- datos_todos %>%
  group_by(year) %>%
  summarise(tasa_promedio = mean(age_adjusted_death_rate, na.rm = TRUE)) %>%
  mutate(year = as.integer(year))

comparacion <- merge(west_virginia, promedio_nacional, by = "year")

ggplot(comparacion) +
  geom_line(aes(x = year, y = age_adjusted_death_rate, color = "West Virginia"), size = 1.2) +
  geom_line(aes(x = year, y = tasa_promedio, color = "Promedio_Nacional"), size = 1.2) +
  scale_x_continuous(breaks = seq(1999, 2017, by = 2)) +
  scale_color_manual(values = c("West Virginia" = "blue", "Promedio_Nacional" = "red")) +
  labs(x = "Año", y = "Tasa ajustada por 100,000", color = "") +
  theme_minimal()
```

```{r}
ranking_2017 <- datos_todos %>%
  filter(year == 2017) %>%
  arrange(desc(age_adjusted_death_rate))

which(ranking_2017$state == "West Virginia")
```

Se presenta la evolución de la tasa de mortalidad ajustada por edad (por cada 100,000 habitantes) para el período 2002‑2017: la primera corresponde al promedio nacional de Estados Unidos, mientras que la segunda compara la serie nacional (roja) con la de West Virginia (azul).

Ambas curvas muestran una tendencia descendente sostenida: la tasa nacional se reduce de aproximadamente 7,700 a 7,600, y la de West Virginia de aproximadamente 10,000 a 9,600. Sin embargo, a pesar de esta mejora paralela, la brecha absoluta entre el estado y el país se mantiene constante en torno a 1,800‑2,000 puntos durante todo el periodo, lo que indica que West Virginia persistentemente registra una carga de mortalidad muy superior al promedio nacional. De hecho, en 2017 West Virginia ocupa el primer lugar entre todos los estados con la mayor tasa de mortalidad ajustada por edad del país.

Esta diferencia refleja la influencia de determinantes sociales y sanitarios desfavorables en el estado: mayor prevalencia de enfermedades crónicas, estilos de vida menos saludables, acceso limitado a servicios de salud y condiciones socioeconómicas más precarias, que impiden que las mejoras generales en salud pública se traduzcan en una convergencia con el resto del país. Así, aunque ambos contextos avanzan positivamente, la desigualdad territorial se consolida, subrayando la necesidad de políticas focalizadas que aborden las causas estructurales de la peor salud poblacional en West Virginia.
### **9.2 INSIGHTS CLAVE**

### **Insight 1: El dominio inquebrantable de las enfermedades crónicas**

Las enfermedades cardíacas y el cáncer mantienen su posición como las
dos principales causas de muerte durante todo el período (1999‑2017).
Aunque ambas lideran, las cardíacas muestran un descenso sostenido (de
260 a 165 por 100,000), reflejando avances en prevención y tratamiento,
mientras que el cáncer se mantiene más estable. Este doble patrón
confirma el predominio de las enfermedades crónicas en la transición
epidemiológica (Shah et al., 2019).

### **Insight 2: La crisis silenciosa de las "muertes por desesperación"**

Suicidios y lesiones no intencionales aumentan de forma preocupante, con
estas últimas superando 48 por 100,000 en 2017 y una aceleración desde
2014. Este fenómeno, vinculado a la crisis de opioides y al deterioro
socioeconómico (Daugherty et al., 2019), contrasta con la disminución de
otras causas y evidencia la necesidad de abordar determinantes sociales.

### **Insight 3: Disparidades regionales profundas y persistentes**

La brecha de mortalidad entre estados es alarmante: West Virginia (957
por 100,000) duplica prácticamente a Hawái (585). Esta desigualdad,
concentrada en el Sur rural y los Apalaches, se mantiene a lo largo del
período (James, Cossman & Wolf, 2018), reflejando menores niveles
socioeconómicos y peor acceso a salud en esas regiones.

### **Insight 4: El Alzheimer emerge como un desafío creciente**

El Alzheimer asciende del puesto 8 al 6 con un incremento del 173% en
muertes, el más alto entre todas las causas. Su curva ascendente refleja
el envejecimiento poblacional y plantea retos sanitarios y sociales
crecientes ante la falta de tratamientos curativos (Shah et al., 2019).

### **Insight 5: El ranking es dinámico, pero el top 2 es inamovible**

Mientras causas como lesiones no intencionales (del puesto 5 al 3) y
Alzheimer (del 8 al 6) ganan posiciones, y el stroke desciende (del 3 al
5), las enfermedades cardíacas y el cáncer se mantienen inalterables en
los dos primeros lugares. Esta movilidad refleja cambios
epidemiológicos, pero subraya la persistente dominancia de las
enfermedades crónicas.

### **Insight 6: La carga de mortalidad se concentra geográficamente**

California, Texas, Florida y Nueva York concentran el mayor volumen
absoluto de muertes por su alta densidad poblacional. Sin embargo, esto
contrasta con sus bajas tasas ajustadas, evidenciando la diferencia
entre **carga absoluta** (demanda asistencial) y **riesgo relativo**
(probabilidad de morir), lo que orienta la asignación de recursos a
diferentes escalas.

### **10. LIMITACIONES DEL ESTUDIO**

-   **Naturaleza observacional:** Los datos utilizados son de carácter
    observacional y agregado, por lo que permiten identificar
    correlaciones pero no establecer causalidad. No es posible
    determinar, por ejemplo, si el aumento de accidentes se debe a la
    crisis de opioides o a otros factores no medidos.

-   **Ventana temporal acotada:** El análisis cubre hasta 2017, por lo
    que no incorpora el impacto de la pandemia de COVID-19 ni los
    cambios más recientes en la mortalidad por opioides. Los patrones
    observados pueden haber variado después de 2020.

-   **Falta de variables demográficas clave:** El dataset no incluye
    desagregación por sexo, edad o raza, lo que limita el análisis de
    desigualdades intrapoblacionales. No podemos cuantificar, por
    ejemplo, la brecha de género en enfermedades cardíacas o el impacto
    diferencial de la crisis de opioides por grupo étnico.

-   **Agregación nacional vs. estatal:** El análisis por estado se basa
    en promedios que pueden ocultar heterogeneidades internas. Por
    ejemplo, dentro de California existen condados con tasas de
    mortalidad muy diferentes.

### **11. CONCLUSIONES**

El análisis de la mortalidad en Estados Unidos entre 1999 y 2017 revela
transformaciones profundas en el perfil epidemiológico del país: las
enfermedades cardíacas y el cáncer se mantienen como las causas
dominantes, pero mientras las primeras descienden sostenidamente, el
cáncer se estabiliza, mientras que emergen con fuerza nuevas amenazas
como las lesiones no intencionales y el suicidio las llamadas "*muertes*
*por* *desesperación*" que aumentan de manera alarmante, especialmente a
partir de 2014, y el Alzheimer escala posiciones impulsado por el
envejecimiento poblacional, todo ello en un contexto donde las
disparidades geográficas se consolidan como un patrón estructural: los
estados del sur y los Apalaches presentan tasas de mortalidad muy
superiores a la media nacional, reflejando desigualdades socioeconómicas
y de acceso a la salud que persisten a lo largo de todo el período.
Estas evidencias exigen políticas de salud pública diferenciadas que
concentren recursos en los territorios con mayor carga de mortalidad y
aborden los determinantes sociales subyacentes, junto con un abordaje
integral de la crisis de opioides y la salud mental que combine control
de sustancias, acceso a tratamientos y apoyo psicosocial, así como una
preparación del sistema sanitario para el envejecimiento poblacional
mediante el fortalecimiento de la atención geriátrica y la investigación
en enfermedades neurodegenerativas. Los datos son claros: el perfil de
mortalidad ha cambiado, pero las respuestas institucionales aún no están
a la altura de estos nuevos desafíos; es hora de pasar de un enfoque
reactivo a uno proactivo que combine la prevención de enfermedades
crónicas con una acción decidida sobre los determinantes sociales, las
adicciones y el envejecimiento para avanzar hacia un futuro con menos
muertes evitables y mayor equidad en salud.

### **12. REFERENCIAS BIBLIOGRÁFICAS**

-   **Artículo de Demographic Research (James, Cossman & Wolf, 2018)**

    James, W., Cossman, J., & Wolf, J. K. (2018). Persistence of death
    in the United States: The remarkably different mortality patterns
    between America's Heartland and Dixieland. *Demographic Research,
    39*, 897–910. <https://doi.org/10.4054/DemRes.2018.39.33>

-   **Artículo de JAMA (Shah et al., 2019)**

    Shah, N. S., Lloyd-Jones, D. M., O'Flaherty, M., Capewell, S.,
    Kershaw, K. N., Carnethon, M., & Khan, S. S. (2019). Trends in
    cardiometabolic mortality in the United States, 1999-2017. *JAMA,
    322*(8), 780–782. <https://doi.org/10.1001/jama.2019.11245>

-   **Informe de los CDC (Daugherty et al., 2019)**

    Daugherty, J., Waltzman, D., Sarmiento, K., & Xu, L. (2019).
    Traumatic brain injury–related deaths by race/ethnicity, sex,
    intent, and mechanism of injury — United States, 2000–2017. *MMWR.
    Morbidity and Mortality Weekly Report, 68*(46), 1050–1056.
    <https://doi.org/10.15585/mmwr.mm6846a2>
